# RSA-1
>Yú Tóngyī send a message to 3 peoples with unique modulus. But he left it vulnerable. Figure out :)

## Resources:
[out.txt](https://github.com/trxvorr/Writeups/blob/main/scriptCTF/Crypto/RSA-1/out.txt)

## Solution
The text file had:
```text
n1 = 156503881374173899106040027210320626006530930815116631795516553916547375688556673985142242828597628615920973708595994675661662789752600109906259326160805121029243681236938272723595463141696217880136400102526509149966767717309801293569923237158596968679754520209177602882862180528522927242280121868961697240587
c1 = 77845730447898247683281609913423107803974192483879771538601656664815266655476695261695401337124553851404038028413156487834500306455909128563474382527072827288203275942719998719612346322196694263967769165807133288612193509523277795556658877046100866328789163922952483990512216199556692553605487824176112568965

n2 = 81176790394812943895417667822424503891538103661290067749746811244149927293880771403600643202454602366489650358459283710738177024118857784526124643798095463427793912529729517724613501628957072457149015941596656959113353794192041220905793823162933257702459236541137457227898063370534472564804125139395000655909
c2 = 40787486105407063933087059717827107329565540104154871338902977389136976706405321232356479461501507502072366720712449240185342528262578445532244098369654742284814175079411915848114327880144883620517336793165329893295685773515696260299308407612535992098605156822281687718904414533480149775329948085800726089284

n3 = 140612513823906625290578950857303904693579488575072876654320011261621692347864140784716666929156719735696270348892475443744858844360080415632704363751274666498790051438616664967359811895773995052063222050631573888071188619609300034534118393135291537302821893141204544943440866238800133993600817014789308510399
c3 = 100744134973371882529524399965586539315832009564780881084353677824875367744381226140488591354751113977457961062275480984708865578896869353244823264759044617432862876208706282555040444253921290103354489356742706959370396360754029015494871561563778937571686573716714202098622688982817598258563381656498389039630

e = 3
```

this is the classic low-exponent (e = 3) broadcast attack. To crack it:

Use the three ciphertexts c1,c2,c3c_1,c_2,c_3c1​,c2​,c3​ and moduli n1,n2,n3n_1,n_2,n_3n1​,n2​,n3​.

Combine them with the Chinese Remainder Theorem to reconstruct M=m3 mod NM = m^3 bmod NM=m3modN where N=n1n2n3N = n_1 n_2 n_3N=n1​n2​n3​. Because the original message mmm is smaller than each modulus and m3<Nm^3 < Nm3<N, CRT yields the actual integer m3m^3m3.

Take the integer cube root of MMM to get mmm.

Decode mmm to bytes — the result contained PKCS#7-style padding (0x12 repeated), so stripping that reveals the flag.

Sounds like I know alot?

Well you're wrong, this was the first time I've seen this and so I learnt how it works and asked GPT for a Python script for it:

```python
def egcd(a,b):  
    if b == 0:  
        return (1, 0, a)  
    x,y,g = egcd(b, a % b)  
    return (y, x - (a // b) * y, g)

def invmod(a,m):  
    x,y,g = egcd(a,m)  
    if g != 1:  
        raise Exception("no inverse")  
    return x % m

def iroot(k, n):  
    low, high = 0, 1 << ((n.bit_length()+k-1)//k + 1)  
    while low < high:  
        mid = (low+high)//2  
        if midk < n:  
            low = mid+1  
        else:  
            high = mid  
    return low-1

n1=156503881374173899106040027210320626006530930815116631795516553916547375688556673985142242828597628615920973708595994675661662789752600109906259326160805121029243681236938272723595463141696217880136400102526509149966767717309801293569923237158596968679754520209177602882862180528522927242280121868961697240587

c1=77845730447898247683281609913423107803974192483879771538601656664815266655476695261695401337124553851404038028413156487834500306455909128563474382527072827288203275942719998719612346322196694263967769165807133288612193509523277795556658877046100866328789163922952483990512216199556692553605487824176112568965

n2=81176790394812943895417667822424503891538103661290067749746811244149927293880771403600643202454602366489650358459283710738177024118857784526124643798095463427793912529729517724613501628957072457149015941596656959113353794192041220905793823162933257702459236541137457227898063370534472564804125139395000655909

c2=40787486105407063933087059717827107329565540104154871338902977389136976706405321232356479461501507502072366720712449240185342528262578445532244098369654742284814175079411915848114327880144883620517336793165329893295685773515696260299308407612535992098605156822281687718904414533480149775329948085800726089284

n3=140612513823906625290578950857303904693579488575072876654320011261621692347864140784716666929156719735696270348892475443744858844360080415632704363751274666498790051438616664967359811895773995052063222050631573888071188619609300034534118393135291537302821893141204544943440866238800133993600817014789308510399

c3=100744134973371882529524399965586539315832009564780881084353677824875367744381226140488591354751113977457961062275480984708865578896869353244823264759044617432862876208706282555040444253921290103354489356742706959370396360754029015494871561563778937571686573716714202098622688982817598258563381656498389039630

e = 3

# CRT combine  
N = n1 * n2 * n3  
m1 = N // n1  
m2 = N // n2  
m3 = N // n3  
C = (m1*invmod(m1,n1)*c1 + m2*invmod(m2,n2)*c2 + m3*invmod(m3,n3)*c3) % N

# integer cube root  
m = iroot(e, C)  
mb = m.to_bytes((m.bit_length()+7)//8, 'big')

# strip PKCS#7 padding  
pad = mb[-1]  
flag = mb[:-pad].decode()  
print(flag)  
```

Running this, we get the flag:
```bash
trevo@kali:~/ctf/scriptctf2025/crypto/RSA-1$ python3 solve.py    
scriptCTF{y0u_f0und_mr_yu's_s3cr3t_m3g_12a4e4}  
```
